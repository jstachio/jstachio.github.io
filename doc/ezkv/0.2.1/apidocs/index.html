<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) -->
<title>Overview (Ezkv API 0.2.1)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="module index">
<meta name="generator" content="javadoc/ModuleIndexWriter">
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="jstachio.css" title="Style">
<link rel="stylesheet" type="text/css" href="script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="script.js"></script>
<script type="text/javascript" src="script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="script-dir/jquery-ui.min.js"></script>
</head>
<body class="module-index-page">
<script type="text/javascript">var pathtoroot = "./";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>                 <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/properties.min.js"></script>                 <script>hljs.highlightAll();</script></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li class="nav-bar-cell1-rev">Overview</li>
<li>Module</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html#overview">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list"></div>
<div class="nav-list-search"><a href="search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<nav class="js-toc"></nav>
<h1 class="title"><img src ="resources/ezkv_logo.svg" alt="EZKV logo" title="EZKV (pronounced ee-zee kee-vee)" width="66%" />               <div style="text-align: center; font-size: x-small; color: limegreen; padding-bottom:2em">                 <em>(pronounced "ee-zee kee-vee")</em>               </div>               Ezkv API 0.2.1</h1>
</div>
<div class="block"><h1 id="user-guide-heading" class="overview">User Guide</h1>

<strong>
Ezkv: JDK 21+ micro configuration framework 
</strong>
<p>
 <strong><em>"Ezkv lemon squeezy!"</em></strong>
</p>
<p>
<em>
A non-opinionated Java bootstrapping configuration library that allows recursive chain loading of configuration from key values.
</em>
</p>


<h2 id="contents-heading" class="toc-title">Contents</h2>

<div class="js-toc-content">

<h2 id="description">Description</h2>

<p>A non-opinionated Java <em>bootstrapping configuration</em> library that allows recursive chain loading of configuration from key values.</p>

<p><strong>Key values are everywhere</strong> (also known as associative arrays, list of tuples, or name-value pairs)!</p>

<p>Environment variables, system properties, cloud metadata, vault, HTTP FORM post, URI queries, command line arguments, and even most forms of JSON, HOCON, TOML, YAML, and XML can all be represented as simple <em>"key value"</em> pairs.</p>

<p>Thus, it is the perfect common denominator for providing applications with initial configuration. We call this <em>"bootstrapping configuration"</em> and it is usually gathered even before logging.</p>

<p>To do this, Ezkv loads streams of key values (<code>KeyValue</code>) from resources. What is unique about it is that certain key values will load more key values to the current stream, which is what we call chaining.</p>

<pre><code>URI -&gt; KeyValues* -&gt; URI* -&gt; KeyValues -&gt; ...
</code></pre>

<p>Streams are useful because they can be filtered and transformed, which matters because keys and values from various sources often need transformation. For example, environment variable names often need to be converted to lower case, and some prefix removed.</p>

<p><strong>In short, it is a micro configuration framework that itself can be configured with key values.</strong></p>

<h2 id="why-and-use-case">Why and Use Case</h2>
<p>Ezkv allows <strong>"users"</strong> to decide where their configuration comes from, instead of developers.</p>

<p>A simple command-line application use case might be like <a href="https://github.com/BurntSushi/ripgrep" target="_blank">ripgrep</a>, 
where a single environment variable dictates the location of configuration. Ezkv easily supports this style and also allows the user to load additional configuration 
from other places using key values in the configuration file. Ezkv can even enable configuration to come from other environment variables, 
which is something not typically possible with tools like ripgrep or similar utilities.</p>

<p>Another use case might be to simulate Spring Boot's configuration loading but without the rest of Spring Boot. Ezkv can achieve this declaratively through key values. 
In fact, a user could configure the previously mentioned ripgrep environment variable to perform a Spring Boot-like load of configuration.</p>


<h2 id="adding-ezkv">Adding Ezkv to Your Project</h2>

<p>To use Ezkv in your project, add the following dependency to your build configuration:</p>

<h3 id="maven">Maven</h3>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.jstach.ezkv&lt;/groupId&gt;
  &lt;artifactId&gt;ezkv-kvs&lt;/artifactId&gt;
  &lt;version&gt;0.2.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</div>


<h3 id="gradle">Gradle</h3>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-kotlin">implementation 'io.jstach.ezkv:ezkv-kvs:0.2.1'
</code></pre>
</div>


<h2 id="example-usage">Example Usage</h2>

<p>A simple example using <code>java.util.Properties</code> files that could be parsed to <code>KeyValues</code>:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code>var kvs = KeyValuesSystem.defaults()
    .loader()
    .variables(Variables::ofSystemProperties) // Use system properties as base variables for interpolation
    .add("classpath:/start.properties")       // Use a classpath properties file
    .add("system:///")                        // add system properties to override
    .add("env:///")                           // add environment variables to override
    .add("cmd:///?_filter_sed=s/^-D//")       // add command line for final override using the prefix of -D
    .load();

// Give the key values to some other config framework like Spring:
var map = kvs.toMap();
ConfigurableEnvironment env = applicationContext.getEnvironment();
env.getPropertySources().addFirst(new MapPropertySource("start", map));
</code></pre>
</div>


Now in  <code>start.properties</code> you load more resources with special keys:

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_foo=file:/./myapp.properties?_flag=optional # optionally load myapp.properties from the CWD.
</code></pre>
</div>



<h2 id="project_information">Project Information</h2>

<dl class="notes">
  <dt>Source Control</dt>
  <dd><a href="https://github.com/jstachio/ezkv">https://github.com/jstachio/ezkv</a></dd>
  <dt>Team</dt>
  <dd>
    <ul>
      <li><a href="https://github.com/agentgt">Adam Gent (agentgt)</a> - lead</li>
    </ul>
  </dd>
  <dt>Issues</dt>
  <dd><a href="https://github.com/jstachio/ezkv/issues">https://github.com/jstachio/ezkv/issues</a></dd>
  <dt>Community</dt>
  <dd><a href="https://github.com/jstachio/ezkv/discussions">https://github.com/jstachio/ezkv/discussions</a></dd>
  <dt>User Guide</dt>
  <dd>
    <a href="index.html">This document</a>
  </dd>
  <dt>Javadoc</dt>
  <dd>
    <a href="#all-modules-table">This document (modules listing at bottom)</a>
  </dd>
</dl>

The project follows the <a href="https://openjdk.org/jeps/14">JDK Tip and Tail</a> 
and <a href="https://semver.org/">semantic versioning</a>.

<h3 id="requirements">Requirements</h3>

<ol>
  <li><a href="https://docs.oracle.com/en/java/javase/21/">Java 21 or greater</a></li>
  <li>A build system that supports running the Java compiler annotation processor</li>
</ol>

The only module needed during runtime is  
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/module-summary.html">
  <code>java.base</code>
</a>


<h2 id="architecture">Architecture</h2>
<p>Ezkv's two major concepts are:</p>
<ol>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a> - a stream of key values</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesResource</code></a> - a URI with associated key-value metadata</li>
</ol>
<p>Resources are used to load key values, and key values can be used to specify and find more resources (to load more key values). Ezkv is recursive.</p>
<p>For the rest of the explanation of architecture, we will go bottom-up.</p>

<h3 id="keyvalue">KeyValue</h3>
<p>A <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValue.html" title="class in io.jstach.ezkv.kvs"><code>KeyValue</code></a> object in ezkv, unlike a <code>Map.Entry&lt;String, String&gt;</code>, has more information than just the simple tuple of <code>key</code> and <code>value</code>.</p>
<ul>
    <li>Immutable</li>
    <li>Have interpolated value as well as the original pre-interpolated value</li>
    <li>Have source information</li>
    <li>Whether or not it should be used for interpolation</li>
    <li>Whether or not it should be printed out ever (e.g., a password or other sensitive information)</li>
</ul>
<p>Ezkv provides ergonomics for working with streams of key values to filter, collect, parse, and format them.</p>
<p><strong>Notice that Ezkv is like a list of key values and thus:</strong></p>
<ul>
    <li>Order can be important</li>
    <li>There can be duplicate "keys" (that may or may not override in the final result)</li>
</ul>
<p>Finally, a <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValue.html" title="class in io.jstach.ezkv.kvs"><code>KeyValue</code></a> can be a special key that can reference another resource to load.</p>
<p>These keys are usually prefixed with <code>_</code> to avoid collision and maximize compatibility. The most important one is <code>_load_name</code>, where <code>name</code> is the name you assign to the resource and the value is a URI. This mini DSL syntax will be configurable in the future, so you can pick different key name patterns.</p>

<h3 id="interpolation">Interpolation</h3>
<p>Ezkv can perform Bash-like interpolation on a stream of <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a> (e.g., <code>${somevar:-${othervar}}</code>). It does this by using the key values themselves and <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/Variables.html" title="interface in io.jstach.ezkv.kvs"><code>Variables</code></a>. <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/Variables.html" title="interface in io.jstach.ezkv.kvs"><code>Variables</code></a> are simply <code>Function&lt;String, String&gt;</code>.</p>
<p>This allows you to interpolate on key values with data you do not want in the final result (<a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a>). For example, it is common to use <code>System.getProperties()</code> as variables, but often you do not want all the system properties to end up in the <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a>.</p>
<p>Variables can be <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesLoader.Builder.html#variables(java.util.function.Function)">added to the loader</a></p>
<p>Interpolation can be disabled with the resource flag <code>no_interpolation</code>.</p>
<p>Finally, you can load a resource as variables instead of <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a> with the resource flag <code>no_add</code>.</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">var kvs = KeyValuesSystem.defaults()
    .loader()
    .add("classpath:/variable.properties?_flag=no_add")  # Use the variable.properties file as variables.
    .add("classpath:/start.properties")
    .load();
</code></pre>
</div>


<code>start.properties</code>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties"># start.properties
_load_app=classpath:/${app.name:-app}.properties
</code></pre>
</div>


<p>If <code>app.name</code> is defined in variable.properties, it will be used in the <code>_load_app</code> URI. Otherwise, <code>app.properties</code> will be used.</p>
<p>Often, interpolation will create a new stream of <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a> where the value part of the key is replaced with the interpolated result; however, the original value is always retained.</p>

<h3 id="keyvaluesresource">KeyValuesResource</h3>
<p>A <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesResource</code></a> has a <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/net/URI.html" title="class or interface in java.net" class="external-link"><code>URI</code></a> and a symbolic name (used to find configuration). 
It is backed by a key value with additional metadata on how to load that resource. 
URIs are designed to point at resources, and the additional metadata in a <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesResource</code></a> is, 
as you might guess, more <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a>.</p>

<p>The additional metadata is used to determine how to load the key values and what metadata should be associated with each key value.</p>

<p>Some examples of metadata use cases include:</p>
<ul>
    <li>The key values from the resource are sensitive and should not be easily printed out.</li>
    <li>The key values should not be interpolated because the data is raw.</li>
    <li>The loaded key values should or should not load other key values.</li>
    <li>The key values need their names transformed or some key values ignored.</li>
</ul>

<p>This is all configurable through key values (and URIs), particularly using the <code>_flags_name</code> key.</p>

<h4 id="resource-key-value-configuration">Resource Key Value Configuration</h4>
<p>Resource loading configuration can be done with special key values. 
These can either be specified in the URI of the resource or as key values within the resource where the <code>_load_[name]</code> is specified.</p>

<p>
    The underscore is a called the prefix. That will be configurable at some point as well as the separator
    which is also an underscore.
</p>
<p>
    The key names without the prefix and separators are:
</p>

<ul>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_LOAD">"load"</a> - resource to load (required)</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_MEDIA_TYPE">"mediaType"</a> or  <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_MIME">"mime"</a> 
        - media type of the resource (not required)
    </li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_FLAGS">"flags"</a>  or <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_FLAG">"flag"</a> 
        - flags for loading</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_PARAM">"param"</a> or <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_PARM">"parm"</a>
        - parameters for custom plugins
    </li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_FILTER">"filter"</a> or <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#KEY_FILT">"filt"</a> 
         - filters</li>
</ul>

The next sections will cover the default key syntax within a resource
or within a URI. 

<h5 id="resource-configuration-in-resource">Resource Configuration in Resource</h5>
<p>The default key-value pattern to specify resources is:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_[name]=URI
_mediaType_[name]=Content Type or file extension to resolve format of resource for parsing
_flags_[name]=CSV of flag names
_param_[name]_[key]=String
_filter_[name]_[filter]=String expression for filter
</code></pre>
</div>


<p>The <code>[name]</code> part should be replaced with a name of your choosing, where only case-sensitive alphanumeric characters are allowed. 
This becomes the symbolic name of the resource. Don't worry—those special keys will be filtered out.</p>

<p>The <code>_load_[name]</code> is the most important key as it dictates the name of the resource and the URI of the resource.</p>

<strong>TIP:</strong> the key aliases like "filt" and "mime" are all 4 characters which is useful for visual alignment or brevity.

<h5 id="resource-configuration-in-uri">Resource Configuration in URI</h5>
<p>The URI of the <code>_load_[name]</code> can also contribute to resource keys using the following format:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_custom=file://./something?_mediaType=properties&amp;_flags=optional&amp;_filter_sed=s/myapp_//&amp;_param_custom=something
</code></pre>
</div>


<p><strong>Notice:</strong> The resource name does not need to be specified with URI parameters, as it is deduced.</p>

<h4 id="resource-flags">Resource Flags</h4>
<p>Resource flags can be set with <code>_flags_[name]</code> in the resource or on the URI with <code>_flags</code>. 
These can be repeatable parameters, and their values are combined.</p>

<p>This is currently a subset of the flags:</p>
<ul>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#FLAG_NO_REQUIRE">"NO_REQUIRE"</a> / <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#FLAG_OPTIONAL">"OPTIONAL"</a> - 
    Resources are usually required to exist; otherwise, an error occurs. This flag makes them not required.</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#FLAG_SENSITIVE">"SENSITIVE"</a> - 
    The key values loaded from the resource will be marked as sensitive and will not be output in <code>toString</code> or similar methods.</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#FLAG_NO_ADD">"NO_ADD"</a> - 
    The key values will not be added to the final result but will instead be used as <code>variables</code>.</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#FLAG_NO_LOAD_CHILDREN">"NO_LOAD_CHILDREN"</a> - 
    The resource is not allowed to chain additional resources (e.g., it cannot use <code>_load_</code> keys).</li>
</ul>

<h4 id="resource-media-type">Resource Media Type</h4>
<p>Ezkv will try to automatically determine the media type of a resource based on the URI file extension. 
However, in some cases, that is not sufficient. The key <code>_mediaType_[name]</code> allows you to explicitly specify the media type.</p>

<p>This is particularly useful for URIs that can load a key containing key-value data. 
A real-world example of this is the <a href="https://docs.spring.io/spring-boot/reference/features/external-config.html" target="_blank">
Spring Boot</a> environment variable <code>SPRING_APPLICATION_JSON</code>.</p>

<p>An example of emulating that behavior in ezkv:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_springJson=env:///SPRING_APPLICATION_JSON?_mediaType=json
</code></pre>
</div>


<p><strong>Note:</strong> JSON support is not provided out-of-the-box (OOB) and will be available as a separate module.</p>

See <a href="#keyvaluesmedia">KeyValuesMedia section</a> for information on how to add more media types.

<h4 id="resource-filters">Resource Filters</h4>
<p>Filters can be applied to a resource to alter the key values after they are loaded but before being added to the final results. 
The ordering of filters matters, so it is generally recommended to use the URI notation, as the order is guaranteed.</p>

<p>The current filters provided out-of-the-box (OOB) are:</p>
<ul>
    <li><code>sed</code> - Similar to the Unix <code>sed</code> utility but only supporting the <code>s</code> (substitute) and <code>d</code> (delete) commands.</li>
    <li><code>grep</code> - Filters keys matching a regular expression.</li>
</ul>

<p>Here is an example of using both filters:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_env=env:///?_filter_grep=^MY_APP_&amp;_filter_sed=s/^MY_APP/myapp./
</code></pre>
</div>


<p>The above configuration will only load environment variables prefixed with <code>MY_APP_</code> and will replace 
<code>MY_APP_</code> with <code>myapp.</code>.</p>

<p>The original key name is always preserved for key tracking, so regardless of how keys are renamed, 
users can still identify where the key-value originally came from.</p>

<p><strong>Note:</strong> 
    To add new filters, implement <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesServiceProvider.KeyValuesFilter.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesServiceProvider.KeyValuesFilter</code></a>. 
    This interface allows you to provide custom filters.
</p>

<h3 id="keyvaluesloader">Resource Loading</h3>

<p>A <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesLoader.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesLoader</code></a> usually takes a <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesResource</code></a> and turns it into <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a>.</p>

<p>It is an <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesServiceProvider.KeyValuesLoaderFinder.html" title="interface in io.jstach.ezkv.kvs"><code>extension point</code></a> that, in simple terms, takes a URI and loads <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a>, usually 
based on the schema of the URI. For example:</p>
<ul>
    <li><code>classpath</code> - Uses the JDK classloader mechanism.</li>
    <li><code>file</code> - Uses <code>java.io</code>/<code>java.nio</code> file loading.</li>
</ul>

<p>This part of the library is extendable, and custom loaders can be manually wired or the service loader can be used.</p>

<p>Out of the box, Ezkv supports the following URI schemas:</p>

<ul>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_CLASSPATH">"classpath"</a> - classpath resource</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_FILE">"file"</a> - file resource</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_SYSTEM">"system"</a> - System properties</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_ENV">"env"</a> - Environment variables</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_CMD">"cmd"</a> - Command line argument pairs separated by <code>=</code></li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_STDIN">"stdin"</a> - Allows Unix piping of key values, often useful for passwords</li>
    <li><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesResource.html#SCHEMA_PROFILE">"profile."</a> - Will load multiple resources based on a CSV of profiles where the profile name replaces part of the URI</li>
</ul>


<p>Other URI schemas will be added in the future, usually as separate modules, such as vaults k8s ConfigMap API, cloud meta data services, 
    distribute key value systems and more.</p>

<p><strong>Note:</strong> To add new loaders, 
    implement <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesServiceProvider.KeyValuesLoaderFinder.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesServiceProvider.KeyValuesLoaderFinder</code></a>
    to optionally load key values based on a URI and resource parameters.</p>

<p><strong>Note:</strong> If no schema is provided, Ezkv assumes it is a file path, which is treated as a URI.</p>

<p>We won’t cover <code>file</code> and <code>classpath</code> here, as they are straightforward and self-explanatory.</p>

<h4 id="uri-schemas-env-system-cmd">URI schema: <code>env</code>, <code>system</code>, <code>cmd</code></h4>

<p><code>env:///</code>, <code>system:///</code>, and <code>cmd:///</code> resources have features that differ from <code>file</code> or <code>classpath</code>.</p>

<p>Each of these URI schemas can take a path that fetches a key value, where the value is used as the source of the key values. 
If no path is provided, all key values of the resource will be loaded.</p>

<p>For example, if we have an environment variable whose value is JSON, we can load it like this:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_springJson=env:///SPRING_APPLICATION_JSON?_mediaType=json
</code></pre>
</div>


<h4 id="uri-schemas-stdin">URI schema: <code>stdin</code></h4>
<p><code>stdin:///</code> without a path assumes that the entire contents of stdin are in <code>java.util.Properties</code> key-value format. 
If this is not the case, it is advisable to specify <code>_mediaType=</code> explicitly with stdin.</p>

<p><code>stdin:///</code> can also bind the input content, parsed as a UTF-8 string, to the key provided in the URI path.</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_stdin=stdin:///db.password?_flag=sensitive,optional
</code></pre>
</div>


<p>The above example is particularly useful for passwords, similar to 
<a href="https://docs.docker.com/reference/cli/docker/login/#password-stdin" target="_blank">how Docker handles passwords from stdin</a>.</p>

<h4 id="uri-schema-profile">URI schema: <code>profile.</code></h4>
<p><strong>Note:</strong> This schema may be renamed to <code>profiles</code> in the future.</p>

<p>The <code>profile</code> schema is one of the more complex <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesLoader.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesLoader</code></a> implementations. 
It allows loading multiple resources based on a CSV list of profile names. Here's an example:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">PROFILES=profile1,profile2 # this could come from an environment variable

_load_profiles=profile.classpath:/app-__PROFILE__.properties
_param_profiles_profile=${PROFILES}
_flags_profiles=no_require
</code></pre>
</div>


<p>The above configuration will attempt to load the following resources:</p>
<ul>
    <li><code>classpath:/app-profile1.properties</code></li>
    <li><code>classpath:/app-profile2.properties</code></li>
</ul>

<p>It will not fail if those resources are not found, as the flag <code>no_require</code> is set.</p>

<p>The logic behind this schema is not special or internal. The <code>profile</code> loader simply generates the following key values:</p>

<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-properties">_load_profiles1=classpath:/app-profile1.properties
_flags_profiles1=no_require
_load_profiles2=classpath:/app-profile2.properties
_flags_profiles2=no_require
</code></pre>
</div>


<p>This means users can create a similar implementation themselves if desired.</p>

<h3 id="keyvaluesmedia">KeyValuesMedia</h3>

<p><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesMedia.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesMedia</code></a></p>

<p>Some <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesLoader.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesLoader</code></a> implementations can directly parse the <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/net/URI.html" title="class or interface in java.net" class="external-link"><code>URI</code></a> into <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValues.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValues</code></a>. 
However, many will rely on a parser to handle the data.</p>

<p>Ezkv provides a framework to parse and format key values from or to byte streams or strings, 
based on <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank">media type</a> 
(also known as "Content Type" or MIME) or file extension.</p>

<p>This part of the library is extendable. Custom media types can be manually wired or loaded using the Java <code>ServiceLoader</code>.</p>

<p>Out of the box, Ezkv supports:</p>
<ul>
    <li><code>java.util.Properties</code> format</li>
    <li>URL Query percent encoding format</li>
</ul>

<p>Additional formats will be added as separate modules, such as dotenv, HOCON, and Terraform/Tofu <code>tfvars.json</code> format.</p>

<p><strong>Note:</strong> To add new media types, implement <a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesServiceProvider.KeyValuesMediaFinder.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesServiceProvider.KeyValuesMediaFinder</code></a>. 
This interface allows you to provide custom parsing logic for new formats.</p>

<h3 id="keyvaluesenvironment">KeyValuesEnvironment</h3>

<p><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesEnvironment.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesEnvironment</code></a></p>
<p>Ezkv provides a facade to access system properties, environment variables, class resource loaders, stdin, 
command-line arguments, and logging. This is particularly useful for unit testing, but the most valuable feature is the logger.</p>

<p>The logger in Ezkv does nothing by default, but users can plug in their own implementations to track resource loading.</p>

<h3 id="keyvaluessystem">KeyValuesSystem</h3>

<p><a href="io.jstach.ezkv.kvs/io/jstach/ezkv/kvs/KeyValuesSystem.html" title="interface in io.jstach.ezkv.kvs"><code>KeyValuesSystem</code></a></p>
<p>This is the entry point into Ezkv and is used to load the initial part of the chain of resources. 
The bootstrapping part of your application will call it first and will often convert or pass the loaded key values to another system.</p>


</div></div>
<div id="all-modules-table">
<div class="caption"><span>Modules</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Module</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color all-modules-table all-modules-table-tab1"><a href="io.jstach.ezkv.boot/module-summary.html">io.jstach.ezkv.boot</a></div>
<div class="col-last even-row-color all-modules-table all-modules-table-tab1">
<div class="block">Ezkv Boot is tiny opinionated configuration framework modeled after Spring
 Boot that uses Ezkv KVS system to load key values into Map.</div>
</div>
<div class="col-first odd-row-color all-modules-table all-modules-table-tab1"><a href="io.jstach.ezkv.kvs/module-summary.html">io.jstach.ezkv.kvs</a></div>
<div class="col-last odd-row-color all-modules-table all-modules-table-tab1">
<div class="block">The <code>io.jstach.ezkv.kvs</code> module provides the core library for Ezkv, a non-opinionated
 Java configuration system that supports recursive chain loading of configuration from key-value
 pairs.</div>
</div>
</div>
</div>
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2024 <a href="https://jstach.io/ezkv">ezkv</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script src="resources/jstachio.js"></script>
</body>
</html>
